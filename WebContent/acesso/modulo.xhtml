<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
      
    <ui:composition template="/new-template/template-crud.xhtml">
    
     	<ui:define name="includeScript">
 			<script type="text/javascript"> 
//  			     jQuery(function($) {
//  			        $("input[id$=nomeSistema]").mask("a*");
//  			     }); 
  			</script>	
		</ui:define>
 
    	<ui:define name="tituloPagina">
    		<h:outputText value="Módulos :: Controle de Acesso :: SME" />
    	</ui:define>
    	
    	<ui:define name="parametros">
    	   <ui:param name="bean" value="#{moduloBean}" />
    	</ui:define>
    	
    	<ui:define name="tituloFieldSetFiltro">
    		<h4> Pesquisa de Módulos </h4>
		</ui:define>
		
		
		<ui:define name="botoesInsertFiltro">
			<p:commandButton value="Novo"
							 actionListener="#{bean['prepareInsert']}" 
							 rendered="#{sessionScope.perms.modulos.ativoBool}"
							 onclick="carregando.show();" 
							 styleClass="btn btn-primary"
							 oncomplete="carregando.hide();"
							 ajax="false"
							 update=":painelGlobal" />
							 
			<p:commandButton value="Excluir" 
							 styleClass="btn btn-primary botaoExcluir"
							 style="display:none;"
							 rendered="#{sessionScope.perms.modulos.removeBool}"
							 onclick="showIf()" />
		</ui:define>
		
		<ui:define name="camposFiltro">				
			<h:panelGrid id="painelGroup" columns="1">		  		
				<h:outputLabel value="Nome: " style="font-weight: normal;"/>
				<p:inputText id="nome" styleClass="form-control" value="#{moduloBean.entitySearch.descricao}" maxlength="50" size="50">
				   	<f:converter converterId="converterStringVazia"/>
					<f:validator validatorId="textoValidatorSge"/>
				</p:inputText>
				<h:message for="nome" tooltip="true" styleClass="error-messages" />
			</h:panelGrid>	
			<p>&nbsp;</p>
		</ui:define>
		
		<ui:define name="tituloPainel">
		  <ui:param name="tituloPainel" value="Módulos" />
		</ui:define>
		
		<ui:define name="resultFiltro">
				<script type="text/javascript">
					$(function(){
						$(".tool-tip").tooltip();
					});
				</script>
				<p:dataTable align="center" 
   							 width="600px" 
   							 id="modulos"
   							 widgetVar="tabelaModulos"
   							 rows="10"
   							 emptyMessage="Nenhum módulo foi encontrado."
   						 	 value="#{moduloBean.resultSearch}" 
       					 	 var="modulo" 
       					 	 paginator="#{moduloBean.resultSearch.rowCount > 0}"
       					 	 paginatorPosition="bottom"
       					 	 rowStyleClass="bgLinha1,bgLinha2"
       					 	 draggableColumns="true">
       					 	 <p:ajax event="page"  oncomplete="attachEventDelete()" />
       					
       						<p:column headerText="" style="width:60px; text-align:center;" styleClass="colunaAcao" rendered="#{sessionScope.perms.modulos.editableBool}" >
								<h:commandLink id="cmdUpd" actionListener="#{moduloBean.prepareUpdate}" style="text-decoration:none;">
								    <i class="glyphicon glyphicon-edit" />
								</h:commandLink>
								<p:tooltip id="toolTipUpdate" for="cmdUpd" value="Editar"
									showEffect="fade" trackMouse="true" />
       						</p:column>
       						
       						<p:column headerText="ID" style="text-align:center;">
       							<h:outputText value="#{modulo.id}" />
       						</p:column>
       						
       						<p:column headerText="Nome" style="text-align:left;" >
       							<h:outputText value="#{modulo.descricao}" />
       						</p:column>
       						
       						<p:column style="width:60px; text-align:center;" rendered="#{sessionScope.perms.modulos.removeBool}" >
       							<f:facet name="header">
       								<h:selectBooleanCheckbox styleClass="ui-checkBoxMain" rendered="#{moduloBean.resultSearch.rowCount > 0}" />
       							</f:facet>
       							<h:selectBooleanCheckbox styleClass="ui-checkBox"
       													 rendered="#{modulo.removable}" 
       													 valueChangeListener="#{moduloBean.select}" />
       							
       							<h:graphicImage value="#{resource['img:icon-warning.png']}"
       											styleClass="tool-tip"
       											title="Módulo já possui transação associada." 
       											rendered="#{not modulo.removable}">	
       							</h:graphicImage>  
       						</p:column>       						
				 	</p:dataTable>
		</ui:define>
		
		<ui:define name="tituloFieldSetInsert">
			<h4> Cadastro de Módulos </h4>
		</ui:define>
		
		<ui:define name="camposInsert">
		 <div class="row">
  		<div class="col-md-8">
			  <h:outputLabel value="Nome: " styleClass="required"/>
			  <h:inputText required="true"
			  			   styleClass="form-control"
			               id="nome" 
						   label="Nome"
						   value="#{moduloBean.entity.descricao}" 
						   maxlength="50" 
						   size="50">						
				  <f:validateLength minimum="3" /> 
			  </h:inputText>
			  <h:message for="nome" tooltip="true" styleClass="error-messages" />
			  
			  <h:outputLabel value="Dominio: "/>
			  
			  <div class="input-group">
  			 <span class="input-group-addon">http://</span>
			  <h:inputText 
			  			   styleClass="form-control "
			               id="dominio" 
						   label="Dominio"
						   value="#{moduloBean.entity.dominio}"
						   maxlength="300" 
						   size="50">
						   <p:ajax event="keyup" process="@this" update="labelUrl"/>
			  </h:inputText>
			  <h:message for="dominio" tooltip="true" styleClass="error-messages" />
			 </div>
			  
			  <h:outputLabel value="Porta: "/>
			  <p:inputMask mask=":99999"
			  			   styleClass="form-control "
			               id="portaMask" 
						   label="Porta"
						   value="#{moduloBean.entity.porta}"
						   maxlength="300" 
						   size="20">
				<p:ajax event="keydown" process="@this" update="labelUrl"/>
			  </p:inputMask>
			  
			  <h:outputLabel value="Nome Do Sistema: " styleClass="required"/>
			  <h:inputText 
			  			   styleClass="form-control"
			               id="nomeSistema" 
			               required="true"
						   label="Nome Do Sistema"
						   value="#{moduloBean.entity.nomeSistema}"
						   maxlength="300" 
						   size="20">
						  <p:ajax event="keyup" process="@this" update="labelUrl"/>
			  </h:inputText>
			  <h:message for="nomeSistema" tooltip="true" styleClass="error-messages" />
			  
			  <h:outputLabel value="URL: "/>
			  <h:inputText
			  	id="labelUrl" 
			  	disabled="true"
			  	styleClass="form-control"
			  	value="http://#{moduloBean.entity.dominio}#{moduloBean.entity.porta}/#{moduloBean.entity.nomeSistema}/" 
			   />	
			   <h:message for="labelUrl" tooltip="true" styleClass="error-messages" />		  
	</div>
</div>
		</ui:define>
		
    </ui:composition>
</html>